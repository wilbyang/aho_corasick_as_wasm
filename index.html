<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Wasm Example</title>
</head>

<body>
    <script type="module">
        

        import init, { AhoSearcher } from './pkg/my_wasm_project.js';

        async function run() {
            // 1. 初始化 Wasm 模块
            await init();

            // 2. 定义你的关键词字典
            const keywords = ['hello', 'world', 'rust', 'wasm'];

            try {
                // 3. 提前初始化：
                //    调用 Rust 构造函数，传入 JS 数组。
                //    Wasm 在内部构建并存储自动机。
                const searcher = new AhoSearcher(keywords);

                // 4. 多次调用搜索，无需重新初始化
                const text1 = 'This is a test text with hello and rust.';
                const matches1 = searcher.search(text1);

                console.log(`Matches in: "${text1}"`);
                console.log(matches1);
                // [
                //   { pattern_index: 0, start: 26, end: 31 }, // 'hello'
                //   { pattern_index: 2, start: 36, end: 40 }  // 'rust'
                // ]

                const text2 = 'Another one, just saying wasm.';
                const matches2 = searcher.search(text2);

                console.log(`Matches in: "${text2}"`);
                console.log(matches2);
                // [
                //   { pattern_index: 3, start: 24, end: 28 } // 'wasm'
                // ]

            } catch (error) {
                // 如果 Rust 抛出错误 (例如初始化时传入了
                //  new AhoSearcher(123) 而不是数组)，
                // 你会在这里捕获到它。
                console.error('Wasm Error:', error);
            }
        }

        run();
    </script>
</body>

</html>